<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- AIと検索エンジンへの拒否設定 -->
    <meta name="robots" content="noindex, nofollow, noarchive">
    <meta name="googlebot" content="noindex, nofollow">
    <!-- タイトルも業務ツールっぽくする -->
    <title>System Log Viewer 1.0</title>
    <style>
        body { font-family: 'Courier New', monospace; max-width: 600px; margin: 0 auto; padding: 20px; background: #222; color: #ddd; }
        h2 { text-align: left; font-size: 1rem; color: #888; border-bottom: 1px solid #444; padding-bottom: 10px; }
        
        /* 難読化されたコンテナ（旧チャットエリア） */
        #sys-mon-disp {
            height: 400px;
            overflow-y: auto;
            border: 1px solid #444;
            background: #1a1a1a;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        /* 難読化されたアイテム（旧メッセージ） */
        .log-row { margin-bottom: 5px; padding: 5px 10px; border-left: 3px solid transparent; display: block; }
        
        /* 自分（Type A）と相手（Type B）の見た目をログっぽくする */
        /* 右寄せ・左寄せをやめ、色だけで区別することでチャット構造を隠す */
        .type-a { border-left-color: #00ff00; background: #002200; color: #aaffaa; }
        .type-b { border-left-color: #ffff00; background: #222200; color: #ffffaa; }

        /* 入力エリアの擬態 */
        .cmd-line { display: flex; gap: 5px; background: #333; padding: 5px; }
        input { flex: 1; padding: 8px; background: #111; border: 1px solid #555; color: #fff; font-family: monospace; outline: none; }
        button { padding: 8px 15px; border: 1px solid #555; background: #444; color: #ccc; cursor: pointer; font-family: monospace; }
        button:hover { background: #555; }
    </style>
</head>
<body>

    <!-- 業務ツールのような見た目 -->
    <h2>>_ System Activity Log</h2>
    
    <div id="sys-mon-disp">
        <!-- データ表示エリア -->
    </div>

    <div class="cmd-line">
        <input type="text" id="val-in" placeholder="Enter value..." autocomplete="off">
        <button id="exec-btn">EXEC</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp } 
        from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // ▼▼▼ ここにご自身のキーを貼り付けてください ▼▼▼
const firebaseConfig = {

  apiKey: "AIzaSyD-ZjLNRLuQt5H_cEjIW7pz2sqb7_fOXIc",

  authDomain: "my-chat-web-dd1e0.firebaseapp.com",

  projectId: "my-chat-web-dd1e0",

  storageBucket: "my-chat-web-dd1e0.firebasestorage.app",

  messagingSenderId: "305254951478",

  appId: "1:305254951478:web:2e53276498acd388e14697",

  measurementId: "G-M84CV53JEK"

};

        // ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 変数名も難読化（area -> display, input -> value）
        const disp = document.getElementById("sys-mon-disp");
        const valIn = document.getElementById("val-in");
        const execBtn = document.getElementById("exec-btn");

        const uid = localStorage.getItem('sys_uid') || Math.random().toString(36).substring(7);
        localStorage.setItem('sys_uid', uid);

        async function pushData() {
            const rawVal = valIn.value;
            if (rawVal.trim() === "") return;

            try {
                // コレクション名を "messages" から "system_logs" に変更して隠蔽
                await addDoc(collection(db, "system_logs"), {
                    payload: rawVal, // text -> payload
                    source: uid,     // senderId -> source
                    ts: serverTimestamp() // createdAt -> ts
                });
                valIn.value = "";
            } catch (e) {
                console.error("Log error: ", e);
            }
        }

        execBtn.addEventListener("click", pushData);
        valIn.addEventListener("keypress", (e) => {
            if (e.key === "Enter") pushData();
        });

        const q = query(collection(db, "system_logs"), orderBy("ts", "asc"));
        
        onSnapshot(q, (snapshot) => {
            disp.innerHTML = "";
            
            snapshot.forEach((doc) => {
                const data = doc.data();
                const el = document.createElement("div");
                
                // チャットの吹き出しではなく「システムログの1行」として表示
                el.textContent = `[LOG] ${data.payload}`; 
                el.classList.add("log-row");
                
                if (data.source === uid) {
                    el.classList.add("type-a");
                } else {
                    el.classList.add("type-b");
                }
                
                disp.appendChild(el);
            });
            
            disp.scrollTop = disp.scrollHeight;
        });
    </script>
</body>
</html>
